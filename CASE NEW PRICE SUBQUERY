select product_id,  name, price, case
when price >= ((select avg(price) from products)+50) then 0.85*price
when price <= ((select avg(price) from products)-50) then 0.9*price
ELSE PRICE
end as new_price
from products
order by price DESC, product_id

Задание:

Назначьте скидку 15% на товары, цена которых превышает среднюю цену на все товары на 50 и более рублей,
а также скидку 10% на товары, цена которых ниже средней на 50 и более рублей.
Цену остальных товаров внутри диапазона (среднее - 50; среднее + 50) оставьте без изменений.
При расчёте средней цены, округлите её до двух знаков после запятой.

Выведите информацию о всех товарах с указанием старой и новой цены.
Колонку с новой ценой назовите new_price. Результат отсортируйте сначала по убыванию прежней цены в колонке price, затем по возрастанию id товара.

Поля в результирующей таблице: product_id, name, price, new_price
